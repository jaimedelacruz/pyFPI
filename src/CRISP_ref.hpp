#ifndef CRISPREFHPP
#define CRISPREFHPP
/* --- 
   CRISP reflectivities and interpolation classes
   Coded by J. de la Cruz Rodriguez (ISP-SU, 2025)
   --- */

#include <array>
#include "math.hpp"

namespace crisp{

  inline constexpr const int nCRISP = 218;

  // ******************************************************************* //
  
  template<typename T>
  constexpr static const std::array<T,nCRISP> crisp_ref_wav =
    {4756.5191, 4756.61  , 4765.7702, 4774.9288, 4781.7796, 4786.353 ,
     4797.752 , 4811.4149, 4829.6344, 4841.0367, 4861.5505, 4868.4148,
     4882.1181, 4886.6983, 4895.8316, 4902.6891, 4907.2608, 4911.8359,
     4918.6834, 4927.8116, 4932.3901, 4943.7891, 4955.1897, 4964.3129,
     4980.2533, 4991.6405, 5005.3017, 5023.5145, 5041.7155, 5053.101 ,
     5078.1393, 5089.5198, 5105.4517, 5121.377 , 5132.7541, 5148.6759,
     5164.5927, 5185.0493, 5203.2267, 5225.9321, 5244.0876, 5257.6983,
     5273.5697, 5291.7017, 5300.7592, 5314.3582, 5321.1468, 5330.2043,
     5339.2585, 5350.5717, 5359.6259, 5368.6801, 5384.5279, 5395.846 ,
     5411.7124, 5427.5888, 5441.2079, 5463.9301, 5477.5746, 5491.2257,
     5502.6028, 5520.8055, 5532.191 , 5545.8388, 5564.0347, 5577.6774,
     5600.4064, 5627.6582, 5648.0895, 5668.509 , 5686.6561, 5702.5241,
     5718.3938, 5731.9927, 5745.5917, 5759.1856, 5772.7829, 5788.6459,
     5802.2432, 5818.1129, 5836.26  , 5854.4138, 5870.3054, 5893.0175,
     5915.7414, 5924.836 , 5938.472 , 5947.5682, 5961.2093, 5977.1211,
     5995.3052, 6013.4843, 6024.8547, 6040.7614, 6056.6681, 6074.8405,
     6095.2852, 6117.9939, 6136.1596, 6161.134 , 6183.8359, 6208.8086,
     6240.585 , 6265.5577, 6288.2547, 6308.6876, 6342.7415, 6374.5246,
     6415.3956, 6456.2632, 6488.0497, 6510.7534, 6535.7261, 6558.4264,
     6581.1334, 6601.5647, 6619.727 , 6640.16  , 6676.4862, 6703.738 ,
     6726.4484, 6749.1588, 6767.3312, 6785.5036, 6801.4069, 6819.5809,
     6842.3015, 6869.5667, 6892.2872, 6912.7354, 6935.4559, 6962.7212,
     6987.7107, 7010.4295, 7039.9588, 7067.214 , 7101.2829, 7137.6193,
     7173.9505, 7203.4697, 7237.5218, 7276.1154, 7307.8935, 7330.5938,
     7362.3718, 7387.3361, 7416.8368, 7446.3408, 7466.7653, 7484.9158,
     7503.068 , 7530.3013, 7550.7225, 7582.4888, 7605.1739, 7634.6746,
     7661.9028, 7691.3984, 7727.7111, 7752.6704, 7784.4451, 7825.2976,
     7859.3497, 7891.1312, 7916.1055, 7945.623 , 7975.1405, 7997.8492,
     8047.8047, 8079.5929, 8113.6551, 8152.2588, 8181.7796, 8209.0297,
     8240.823 , 8261.2627, 8286.2438, 8315.768 , 8347.5612, 8368.006 ,
     8388.4524, 8411.1746, 8440.7106, 8472.524 , 8497.5186, 8520.2458,
     8538.43  , 8561.1555, 8592.9521, 8624.7571, 8645.2086, 8663.3911,
     8681.5752, 8695.2146, 8713.3971, 8736.126 , 8752.0378, 8770.2135,
     8790.6616, 8813.3855, 8829.2939, 8847.4696, 8870.1885, 8888.3659,
     8913.3537, 8938.3399, 8961.0486, 8990.5678, 9008.7283, 9040.5132,
     9060.9428, 9081.3707, 9097.2572, 9119.9508, 9140.3703, 9163.0571,
     9183.4682, 9197.0773};

  // ******************************************************************* //

  template<typename T>
  constexpr static const std::array<T,nCRISP> crisp_ref_lre =
    {0.99308955, 0.99308459, 0.9924868 , 0.99171951, 0.99105585,
     0.99057834, 0.98929989, 0.98767941, 0.98538641, 0.98366905,
     0.97984938, 0.97833248, 0.97477179, 0.9733714 , 0.97017941,
     0.96737725, 0.9650363 , 0.96207052, 0.95690647, 0.94946324,
     0.94530623, 0.93406109, 0.9217552 , 0.91124603, 0.89177169,
     0.87768732, 0.86249181, 0.84736052, 0.83997866, 0.84020089,
     0.84274956, 0.84562637, 0.8517546 , 0.85680426, 0.86061462,
     0.86369221, 0.86509285, 0.86506554, 0.86338041, 0.86001028,
     0.857376  , 0.85458077, 0.85143192, 0.84820292, 0.84649757,
     0.84507018, 0.84471025, 0.84464107, 0.84500646, 0.84607899,
     0.84778066, 0.84908069, 0.85213403, 0.85492724, 0.85838425,
     0.86243786, 0.86677827, 0.87324347, 0.87603086, 0.87871175,
     0.88105359, 0.88482766, 0.88647099, 0.88803463, 0.8898667 ,
     0.89084728, 0.89100719, 0.89099276, 0.88995   , 0.88827681,
     0.88653223, 0.88475547, 0.88280881, 0.88093474, 0.87878176,
     0.87630711, 0.87380963, 0.87086785, 0.86839522, 0.8655781 ,
     0.86266717, 0.85987725, 0.85729862, 0.85459831, 0.85254006,
     0.85175569, 0.85069492, 0.85017801, 0.84978257, 0.84952331,
     0.8491516 , 0.84856875, 0.84822543, 0.8478618 , 0.84752794,
     0.84710376, 0.84661762, 0.84608871, 0.84564752, 0.84503824,
     0.8442327 , 0.84280487, 0.84139561, 0.84035331, 0.83932556,
     0.83841661, 0.83741007, 0.83741007, 0.83904214, 0.84087666,
     0.84252617, 0.84440055, 0.84653635, 0.84869069, 0.85114624,
     0.8532265 , 0.85492849, 0.85652434, 0.85942519, 0.86136244,
     0.86226084, 0.86300343, 0.8637062 , 0.86427879, 0.86438849,
     0.86438849, 0.86438849, 0.86415887, 0.86371169, 0.86326253,
     0.86262213, 0.86166705, 0.86055708, 0.85949828, 0.85807809,
     0.85708954, 0.85596091, 0.85444937, 0.85431655, 0.85431655,
     0.85439977, 0.85474172, 0.85604145, 0.85670948, 0.85724384,
     0.85778477, 0.85872491, 0.8595198 , 0.86000223, 0.86032939,
     0.86043165, 0.86043165, 0.86043168, 0.86089876, 0.86115021,
     0.86085252, 0.86039219, 0.85983246, 0.85896705, 0.85823987,
     0.85721711, 0.85587621, 0.85478784, 0.8537074 , 0.85309818,
     0.85246097, 0.85172796, 0.85126223, 0.85071942, 0.85071942,
     0.85094453, 0.85123077, 0.85144354, 0.85182846, 0.85231483,
     0.85258211, 0.85299854, 0.85374356, 0.85500943, 0.8553853 ,
     0.85517492, 0.85503597, 0.85503597, 0.85452095, 0.85360889,
     0.85265557, 0.8517887 , 0.85031761, 0.84676128, 0.84244613,
     0.83947991, 0.83687012, 0.83555347, 0.83441214, 0.83198797,
     0.82889236, 0.82628899, 0.82273377, 0.81916957, 0.81430479,
     0.81131788, 0.8052597 , 0.80137935, 0.79703999, 0.7890059 ,
     0.77891092, 0.77083209, 0.75908099, 0.75007846, 0.73313014,
     0.72226201, 0.70796153, 0.69687158, 0.67836665, 0.66332067,
     0.6458012 , 0.62241467, 0.60884994};

  // ******************************************************************* //

  template<typename T>
  constexpr static const std::array<T,nCRISP> crisp_ref_hre =
    {0.85111971, 0.85712416, 0.86223926, 0.86724316, 0.86980076,
       0.87191354, 0.87491601, 0.87747376, 0.88103235, 0.88425721,
       0.88937255, 0.8928197 , 0.89804609, 0.90060364, 0.90393965,
       0.90694202, 0.9089436 , 0.91116757, 0.91350278, 0.91650521,
       0.91895156, 0.92195404, 0.9250677 , 0.92773654, 0.93073912,
       0.93296323, 0.93540979, 0.9385236 , 0.94085906, 0.94297199,
       0.9469755 , 0.94875484, 0.95120144, 0.95320327, 0.95476023,
       0.95653967, 0.95798554, 0.9593203 , 0.96009905, 0.95998836,
       0.95932159, 0.95843234, 0.95687598, 0.9546525 , 0.9529848 ,
       0.95131719, 0.94976063, 0.94809293, 0.94620284, 0.94353444,
       0.94164435, 0.93975426, 0.93664118, 0.93430637, 0.93241642,
       0.93119364, 0.93086036, 0.9318616 , 0.93319621, 0.93497561,
       0.93653256, 0.93897922, 0.94109214, 0.94264915, 0.94465103,
       0.94587445, 0.94732046, 0.94754345, 0.94721031, 0.94609882,
       0.94487609, 0.94309734, 0.94142978, 0.93976218, 0.93809457,
       0.93609338, 0.93431459, 0.93220226, 0.93042346, 0.9287559 ,
       0.92753317, 0.92675521, 0.92653317, 0.92686724, 0.92797967,
       0.92875823, 0.92953688, 0.93042662, 0.93153886, 0.93265114,
       0.93387466, 0.93476461, 0.93587679, 0.93665549, 0.93743419,
       0.93787936, 0.93843578, 0.93854746, 0.93854786, 0.93832602,
       0.93799293, 0.9376599 , 0.93677104, 0.93643801, 0.93577134,
       0.9355494 , 0.93510537, 0.93466129, 0.93455098, 0.93421829,
       0.9339966 , 0.93377471, 0.93344167, 0.93299739, 0.93299789,
       0.93266475, 0.93244276, 0.93222082, 0.93188803, 0.93211101,
       0.9323339 , 0.93255678, 0.93300195, 0.93344712, 0.93400343,
       0.9345598 , 0.93544984, 0.93656237, 0.93745241, 0.93823121,
       0.93912125, 0.94023378, 0.94101268, 0.94179153, 0.94245934,
       0.94290471, 0.94346142, 0.94379579, 0.94379658, 0.94379722,
       0.943242  , 0.94268687, 0.94190921, 0.94146493, 0.94068727,
       0.93979827, 0.93857578, 0.93757568, 0.93679778, 0.93579743,
       0.93490828, 0.93390813, 0.93290783, 0.93135182, 0.9299068 ,
       0.92868431, 0.92735058, 0.92579452, 0.92457218, 0.9233496 ,
       0.92234955, 0.92101612, 0.92046089, 0.91990562, 0.91968378,
       0.91957323, 0.91946268, 0.91957437, 0.91957545, 0.91946495,
       0.91957689, 0.91968893, 0.91980076, 0.91991255, 0.92013563,
       0.92035846, 0.92058139, 0.92091562, 0.9211387 , 0.92169511,
       0.92236272, 0.92336396, 0.92447653, 0.92603394, 0.92714642,
       0.92848123, 0.92970476, 0.93092838, 0.93137385, 0.93237528,
       0.93337647, 0.9344888 , 0.93571233, 0.93671337, 0.9378257 ,
       0.93927171, 0.94038399, 0.94105155, 0.94183035, 0.94294278,
       0.94383267, 0.94450023, 0.94527908, 0.94605783, 0.94672553,
       0.94728205, 0.94739373, 0.94739438, 0.94706119, 0.94672831,
       0.94628398, 0.94572846, 0.94517284, 0.94428378, 0.94317229,
       0.94183847, 0.94017101, 0.93917056};
  
  // ******************************************************************* //

  // --- Reflectivities interpolators, defined as templates for any
  //     floating point data type --- //
  
  template<typename T> static const
  mth::Linear1D<T,nCRISP> CRISP_REF_HRE(crisp_ref_wav<T>, crisp_ref_hre<T>);

  template<typename T> static const
  mth::Linear1D<T,nCRISP> CRISP_REF_LRE(crisp_ref_wav<T>, crisp_ref_lre<T>);
  
  // ******************************************************************* //

}



#endif

